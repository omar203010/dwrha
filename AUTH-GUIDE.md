# ๐ ุฏููู ูุธุงู ุงููุตุงุฏูุฉ - ุฏููุฑูุง

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุตุงุฏูุฉ ูุชูุงูู ูู "ุฏููุฑูุง" ุญูุซ ูู ุดุฑูุฉ ููุง ุญุณุงุจ ูุณุชูู ููุญููุ ูููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ ูุญููุฉ ุจูุตุงุฏูุฉ ูููุตูุฉ.

---

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ ุงูุณุฑูุน

### 1๏ธโฃ ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช

ูู ุจุชูููุฐ ุงูุณูุฑูุจุช ุงูุชุงูู ูู Supabase SQL Editor:

```sql
-- ูููุฐ ูุญุชูู ููู: supabase-auth-update.sql
```

ูุฐุง ุงูุณูุฑูุจุช ุณูุถูู:
- โ ุญููู ุงููุตุงุฏูุฉ ูุฌุฏูู `companies`
- โ ุฌุฏูู `admin_users` ูููุณุชุฎุฏููู ุงูุฅุฏุงุฑููู
- โ ุฌุฏูู `sessions` ูุฅุฏุงุฑุฉ ุงูุฌูุณุงุช
- โ ุญุณุงุจ ุฅุฏุงุฑู ุงูุชุฑุงุถู

### 2๏ธโฃ ุงูุญุณุงุจ ุงูุฅุฏุงุฑู ุงูุงูุชุฑุงุถู

**ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:** `admin@dawerha.com`  
**ูููุฉ ุงููุฑูุฑ:** `Dawerha@2025`

โ๏ธ **ููู ุฌุฏุงู:** ุบููุฑ ูููุฉ ุงููุฑูุฑ ููุฑุงู ุจุนุฏ ุฃูู ุชุณุฌูู ุฏุฎูู!

---

## ๐ ุณูุฑ ุงูุนูู ุงููุงูู

### ููุดุฑูุงุช:

#### 1. ุงูุชุณุฌูู
```
ุงูุดุฑูุฉ โ index.html โ ุชุณุฌูู ุงูุจูุงูุงุช
         โ
    ูุชู ุฅูุดุงุก ุญุณุงุจ ุชููุงุฆูุงู
         โ
    ูููุฉ ูุฑูุฑ ุนุดูุงุฆูุฉ ูููุฉ
         โ
    ุตูุญุฉ ุงูุดูุฑ + ุจูุงูุงุช ุงูุฏุฎูู
```

**ูุง ูุญุฏุซ ูู ุงูุฎูููุฉ:**
- ุชูููุฏ ูููุฉ ูุฑูุฑ ุขููุฉ ุชููุงุฆูุงู (ูุซุงู: `DwrhaA7xK3m@2025`)
- ุชุดููุฑ ูููุฉ ุงููุฑูุฑ ูุจู ุงูุญูุธ
- ุงูุญุณุงุจ ูููู ุบูุฑ ูุดุท (`is_active = false`)
- ุงูุญุงูุฉ: `pending` (ููุฏ ุงููุฑุงุฌุนุฉ)

#### 2. ุงูููุงููุฉ ูู ุงูุฅุฏุงุฑุฉ
```
ุงูุฅุฏุงุฑุฉ โ admin-dashboard.html
         โ
    ูุฑุงุฌุนุฉ ุงูุทูุจุงุช
         โ
    ุชุบููุฑ status โ "approved"
    ุชุบููุฑ is_active โ true
```

โ๏ธ **ููุงุญุธุฉ:** ูุฌุจ ุนูู ุงูุฅุฏุงุฑุฉ ุชูุนูู ุงูุญุณุงุจุงุช ูุฏููุงู ุญุงููุงู.  
๐ก **ุชุญุณูู ูุณุชูุจูู:** ุฅุถุงูุฉ ูุงุฌูุฉ ูุชูุนูู/ุฑูุถ ุงูุทูุจุงุช ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ.

#### 3. ุชุณุฌูู ุงูุฏุฎูู
```
ุงูุดุฑูุฉ โ login.html
         โ
    ุฅุฏุฎุงู Email + Password
         โ
    ุงูุชุญูู ูู ุงูุจูุงูุงุช
         โ
    ุฅูุดุงุก ุฌูุณุฉ (Session)
         โ
    company-dashboard.html
```

#### 4. ุงููุตูู ูููุญุฉ ุงูุชุญูู
- **ูู company.html:** ุฅุฐุง ูุงูุช ุงูุดุฑูุฉ ูุณุฌูุฉ ุฏุฎููุ ูุธูุฑ ุฒุฑ "ููุญุฉ ุงูุชุญูู"
- **ูู thanks.html:** ุฑุงุจุท ูุจุงุดุฑ ุจุนุฏ ุงูุชุณุฌูู
- **ูู login.html:** ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู ุงููุงุฌุญ

---

## ๐ ุงูุฃูุงู ูุงูุญูุงูุฉ

### ูุณุชููุงุช ุงูุญูุงูุฉ:

1. **ุชุดููุฑ ูููุงุช ุงููุฑูุฑ:**
   - ุงุณุชุฎุฏุงู Base64 + Salt ูุฎุตุต
   - ๐ก ููุฅูุชุงุฌ: ุงุณุชุจุฏู ุจู bcrypt ุฃู argon2

2. **ูุธุงู ุงูุฌูุณุงุช:**
   - Token ูุฑูุฏ ููู ุฌูุณุฉ
   - ุตูุงุญูุฉ ูุญุฏุฏุฉ (24 ุณุงุนุฉ ููุดุฑูุงุชุ 12 ุณุงุนุฉ ููุฅุฏุงุฑุฉ)
   - Session ID ูุฎุฒู ูู `localStorage`
   - ุงูุชุญูู ุงููุฒุฏูุฌ (localStorage + ูุงุนุฏุฉ ุงูุจูุงูุงุช)

3. **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช:**
   - ูู ุดุฑูุฉ ุชุฑู ุจูุงูุงุชูุง ููุท
   - ูุญุงููุฉ ุงููุตูู ูุจูุงูุงุช ุดุฑูุฉ ุฃุฎุฑู = ุฑูุถ + ุฅุนุงุฏุฉ ุชูุฌูู
   - ููุญุฉ ุงูุฅุฏุงุฑุฉ: ุชุญูู ูู ููุน ุงููุณุชุฎุฏู (`admin`)

4. **Row Level Security:**
   - ูููุนูู ุนูู ุฌููุน ุงูุฌุฏุงูู ุงูุญุณุงุณุฉ
   - ุณูุงุณุงุช ูุฑุงุกุฉ ููุชุงุจุฉ ููุงุณุจุฉ

---

## ๐ฏ ุงููููุงุช ุงูุฌุฏูุฏุฉ

| ุงูููู | ุงููุตู |
|------|-------|
| `supabase-auth-update.sql` | ุณูุฑูุจุช ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| `auth.js` | ูุธุงู ุงููุตุงุฏูุฉ ุงููุงูู |
| `login.html` | ุตูุญุฉ ุชุณุฌูู ุฏุฎูู ุงูุดุฑูุงุช |
| `admin-login.html` | ุตูุญุฉ ุชุณุฌูู ุฏุฎูู ุงูุฅุฏุงุฑุฉ |

## ๐ ุงููููุงุช ุงูููุนุฏููุฉ

| ุงูููู | ุงูุชุนุฏููุงุช |
|------|----------|
| `main.js` | ุฅูุดุงุก ุญุณุงุจ ุชููุงุฆูุงู ุนูุฏ ุงูุชุณุฌูู |
| `thanks.html` | ุนุฑุถ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู |
| `company.html` | ุฒุฑ ููุญุฉ ุงูุชุญูู + ุชุณุฌูู ุงูุฎุฑูุฌ |
| `company-dashboard.html` | ุญูุงูุฉ ุจุงููุตุงุฏูุฉ |
| `admin-dashboard.html` | ุญูุงูุฉ ุจุงููุตุงุฏูุฉ |

---

## ๐๏ธ ุฏูุงู ูุธุงู ุงููุตุงุฏูุฉ (auth.js)

### ููุดุฑูุงุช:
```javascript
// ุชุณุฌูู ุงูุฏุฎูู
await window.authSystem.loginCompany(email, password);

// ุงูุญุตูู ุนูู ุงูุฌูุณุฉ ุงูุญุงููุฉ
const session = window.authSystem.getCurrentSession();

// ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู (ููุตูุญุงุช ุงููุญููุฉ)
await window.authSystem.requireAuth('company');

// ุชุณุฌูู ุงูุฎุฑูุฌ
window.authSystem.logout();
```

### ููุฅุฏุงุฑุฉ:
```javascript
// ุชุณุฌูู ุฏุฎูู ุฅุฏุงุฑู
await window.authSystem.loginAdmin(email, password);

// ุงูุชุญูู ูู ุตูุงุญูุงุช ุฅุฏุงุฑูุฉ
await window.authSystem.requireAuth('admin');
```

### ุนุงูุฉ:
```javascript
// ุชูููุฏ ูููุฉ ูุฑูุฑ ูููุฉ
generatePassword(); // โ "DwrhaX7mK2@2025"

// ุชุดููุฑ ูููุฉ ุงููุฑูุฑ
hashPassword("mypassword"); // โ encrypted string
```

---

## ๐ ูููู ุงูุฌูุณุฉ (Session)

```javascript
{
  token: "dwrha_abc123...",
  userType: "company" | "admin",
  userId: 123,
  email: "company@example.com",
  name: "ุงุณู ุงูุดุฑูุฉ",
  expiresAt: "2025-10-08T12:00:00Z"
}
```

---

## ๐ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุงูุณููุงุฑูู 1: ุดุฑูุฉ ุฌุฏูุฏุฉ ุชุณุฌู

```
1. ุงูุดุฑูุฉ ุชูุชุญ index.html
2. ุชููุฃ ุงููููุฐุฌ ูุชุฑุณู
3. โ ูุชู ุฅูุดุงุก:
   - ุณุฌู ูู ุฌุฏูู companies
   - ูููุฉ ูุฑูุฑ ุนุดูุงุฆูุฉ ูุดูุฑุฉ
   - ุงูุญุงูุฉ: pending, is_active: false
4. ุชูุญููู ูุตูุญุฉ thanks.html
5. ุชุนุฑุถ ููุง:
   - ุฑุงุจุท ุงูุนุฌูุฉ
   - ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู
   - ุฑุงุจุท login.html
6. โณ ุชูุชุธุฑ ููุงููุฉ ุงูุฅุฏุงุฑุฉ
```

### ุงูุณููุงุฑูู 2: ุงูุฅุฏุงุฑุฉ ุชูุนูู ุงูุญุณุงุจ

```
1. ุงูุฅุฏุงุฑุฉ ุชุฏุฎู admin-dashboard.html
2. ุชุฑู ุฌุฏูู ุงูุดุฑูุงุช
3. ุชูุชุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Supabase)
4. UPDATE companies 
   SET status = 'approved', is_active = true 
   WHERE id = X
5. โ ุงูุดุฑูุฉ ุงูุขู ูููููุง ุชุณุฌูู ุงูุฏุฎูู
```

๐ก **ุชุญุณูู ูุณุชูุจูู:** ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุชูุนูู/ุฑูุถ ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ.

### ุงูุณููุงุฑูู 3: ุงูุดุฑูุฉ ุชุณุฌู ุฏุฎูู

```
1. ุงูุดุฑูุฉ ุชูุชุญ login.html
2. ุชุฏุฎู Email + Password
3. โ ุงูุชุญูู:
   - ุงูุจุฑูุฏ ููุฌูุฏุ
   - ูููุฉ ุงููุฑูุฑ ุตุญูุญุฉุ
   - is_active = trueุ
   - status = approvedุ
4. ุฅูุดุงุก Session ุฌุฏูุฏุฉ
5. ุชุญููู โ company-dashboard.html
6. โ ุชุฑู ุฅุญุตุงุฆูุงุชูุง
```

### ุงูุณููุงุฑูู 4: ุนููู ูุฏุฎู ุตูุญุฉ ุงูุนุฌูุฉ

```
1. ุนููู ููุชุญ company.html?id=123
2. โ ูุฑู:
   - ุงุณู ุงูุดุฑูุฉ
   - ุงูุนุฌูุฉ
   - ุฒุฑ "ุชุณุฌูู ุฏุฎูู ุงููุงูู" (ุตุบูุฑ)
3. ุฅุฐุง ูุงู ุงููุงูู ูุณุฌู ุฏุฎูู:
   โ ูุฑู: "ููุญุฉ ุงูุชุญูู" + "ุชุณุฌูู ุงูุฎุฑูุฌ"
4. ููุนุจ ููููุฒ ุจุงูุฌุงุฆุฒุฉ
5. โ ุงูุจูุงูุงุช ุชูุญูุธ ุชููุงุฆูุงู
```

---

## โก ุงูุชุญุณููุงุช ุงูููุชุฑุญุฉ

### ูุฑูุจุงู:
1. **ูุงุฌูุฉ ุชูุนูู ุงูุญุณุงุจุงุช:**
   - ุฃุฒุฑุงุฑ Approve/Reject ูู admin-dashboard
   - ุฅุดุนุงุฑุงุช ููุดุฑูุงุช ุนุจุฑ ุงูุจุฑูุฏ

2. **ุชุบููุฑ ูููุฉ ุงููุฑูุฑ:**
   - ุตูุญุฉ ูุชุบููุฑ ูููุฉ ุงููุฑูุฑ
   - "ูุณูุช ูููุฉ ุงููุฑูุฑ" ูุน ุฅุฑุณุงู ุฑุงุจุท

3. **ุฃุฏูุงุฑ ูุชุนุฏุฏุฉ ููุฅุฏุงุฑุฉ:**
   - super_admin: ูู ุงูุตูุงุญูุงุช
   - admin: ุตูุงุญูุงุช ูุญุฏูุฏุฉ
   - viewer: ูุฑุงุกุฉ ููุท

### ูุงุญูุงู:
4. **Two-Factor Authentication (2FA)**
5. **ุชุณุฌูู ุงูุฏุฎูู ุจู OAuth** (Google, Facebook)
6. **ุชุดููุฑ ุฃููู** (bcrypt, argon2)
7. **Refresh Tokens** ูุฌูุณุงุช ุฃุทูู
8. **IP Whitelisting** ููุฅุฏุงุฑุฉ
9. **Audit Logs** - ุณุฌู ูู ุงูุนูููุงุช

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "ุงูุจุฑูุฏ ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ"
**ุงูุญู:**
- ุชุฃูุฏ ูู ูุชุงุจุฉ ุงูุจุฑูุฏ ุจุดูู ุตุญูุญ
- ูููุฉ ุงููุฑูุฑ ุญุณุงุณุฉ ูุญุงูุฉ ุงูุฃุญุฑู
- ุชุฃูุฏ ูู ูุณุฎ ูููุฉ ุงููุฑูุฑ ูู ุตูุญุฉ ุงูุดูุฑ

### ุงููุดููุฉ: "ุญุณุงุจู ุบูุฑ ููุนูู"
**ุงูุญู:**
- ุงูุชุธุฑ ููุงููุฉ ุงูุฅุฏุงุฑุฉ
- ุชูุงุตู ูุน ูุฑูู ุฏููุฑูุง
- ุชุญูู ูู ุงูุญุงูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงููุดููุฉ: "ููุณ ูุฏูู ุตูุงุญูุฉ"
**ุงูุญู:**
- ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ุงูุญุณุงุจ ุงูุตุญูุญ
- ูุง ููููู ุฑุคูุฉ ุจูุงูุงุช ุดุฑูุงุช ุฃุฎุฑู
- ุณุฌูู ุฏุฎูู ุจุญุณุงุจู ุงูุฎุงุต

### ุงููุดููุฉ: ุงูุฌูุณุฉ ุงูุชูุช
**ุงูุญู:**
- ุณุฌูู ุฏุฎูู ูุฑุฉ ุฃุฎุฑู
- ุงูุฌูุณุงุช ุตุงูุญุฉ ูู 24 ุณุงุนุฉ ููุท
- ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ุงูุณุญ ุงููุงุด

---

## ๐ ุจูุงูุงุช ุงูุงุชุตุงู ููุฏุนู

ูููุณุงุนุฏุฉ ูู ูุธุงู ุงููุตุงุฏูุฉ:
- ุฑุงุฌุน ูุฐุง ุงูุฏููู
- ุชุญูู ูู Console ุงููุชุตูุญ
- ุชูุงุตู ูุน ูุฑูู ุงูุชุทููุฑ

---

## ๐ ุงูุฎูุงุตุฉ

โ **ูุธุงู ูุตุงุฏูุฉ ูุงูู ููุญูู**  
โ **ูู ุดุฑูุฉ ููุง ุญุณุงุจูุง ุงููุณุชูู**  
โ **ููุญุฉ ุฅุฏุงุฑูุฉ ูุญููุฉ ุจุดูู ูููุตู**  
โ **ุฌูุณุงุช ุขููุฉ ูุน ุงูุชูุงุก ุตูุงุญูุฉ**  
โ **ุญูุงูุฉ ูุชุนุฏุฏุฉ ุงููุณุชููุงุช**  
โ **ุณูู ุงูุงุณุชุฎุฏุงู ูุงูุชุทููุฑ**  

**"ุฏููุฑูุง" ุงูุขู ููุตุฉ ุขููุฉ ูุงุญุชุฑุงููุฉ!** ๐๐

